"use strict";(()=>{var e={};e.id=303,e.ids=[303],e.modules={1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7951:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>m,routeModule:()=>y});var s={};r.r(s),r.d(s,{default:()=>handler});var o=r(1802),a=r(7153),n=r(6249),i=r(1924),c=r(1185),l=r.n(c);let u=new(l()).Schema({name:{type:String,required:!0},mobile:{type:String,required:!0},email:{type:String},address:{type:String,required:!0},apartmentComplex:{type:String},subscriptionType:{type:String,enum:["weekly","monthly"],default:"weekly"},subscriptionStart:{type:Date},subscriptionEnd:{type:Date},isActive:{type:Boolean,default:!0},createdAt:{type:Date,default:Date.now}}),d=l().models.Customer||l().model("Customer",u);async function handler(e,t){await (0,i.Z)();let{method:r}=e;switch(r){case"GET":try{let e=await d.find({}).sort({createdAt:-1});t.status(200).json({success:!0,data:e})}catch(e){console.error("GET customers error:",e),t.status(400).json({success:!1,error:e.message})}break;case"POST":try{let r=await d.create(e.body);t.status(201).json({success:!0,data:r})}catch(e){console.error("POST customer error:",e),t.status(400).json({success:!1,error:e.message})}break;default:t.status(405).json({success:!1,error:"Method not allowed"})}}let m=(0,n.l)(s,"default"),p=(0,n.l)(s,"config"),y=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/customers",pathname:"/api/customers",bundlePath:"",filename:""},userland:s})},1924:(e,t,r)=>{r.d(t,{Z:()=>i});var s=r(1185),o=r.n(s);let a=process.env.MONGODB_URI||"mongodb://localhost:27017/washify";if(!a)throw Error("Please define the MONGODB_URI environment variable");let n=global.mongoose;async function dbConnect(){if(n.conn)return n.conn;n.promise||(n.promise=o().connect(a,{bufferCommands:!1}).then(e=>e));try{n.conn=await n.promise}catch(e){throw n.promise=null,e}return n.conn}n||(n=global.mongoose={conn:null,promise:null});let i=dbConnect}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222],()=>__webpack_exec__(7951));module.exports=r})();